!function(t){var e;if("function"==typeof define&&define.amd)define(["leaflet"],t);else if("undefined"!=typeof module)e=require("leaflet"),module.exports=t(e);else{if("undefined"==typeof window.L)throw"Leaflet must be loaded first";t(window.L)}}(function(t){"use strict";return t.GeometryUtil=t.extend(t.GeometryUtil||{},{distance:function(t,e,n){return t.latLngToLayerPoint(e).distanceTo(t.latLngToLayerPoint(n))},distanceSegment:function(e,n,r,a){var o=e.latLngToLayerPoint(n),i=e.latLngToLayerPoint(r),l=e.latLngToLayerPoint(a);return t.LineUtil.pointToSegmentDistance(o,i,l)},readableDistance:function(t,e){var n,r="imperial"!==e;return r?n=t>1e3?(t/1e3).toFixed(2)+" km":Math.ceil(t)+" m":(t*=1.09361,n=t>1760?(t/1760).toFixed(2)+" miles":Math.ceil(t)+" yd"),n},belongsSegment:function(t,e,n,r){r=void 0===r?.2:r;var a=e.distanceTo(n),o=e.distanceTo(t)+t.distanceTo(n)-a;return r>o/a},length:function(e){var n=t.GeometryUtil.accumulatedLengths(e);return n.length>0?n[n.length-1]:0},accumulatedLengths:function(t){if("function"==typeof t.getLatLngs&&(t=t.getLatLngs()),0===t.length)return[];for(var e=0,n=[0],r=0,a=t.length-1;a>r;r++)e+=t[r].distanceTo(t[r+1]),n.push(e);return n},closestOnSegment:function(e,n,r,a){var o=e.getMaxZoom();o===1/0&&(o=e.getZoom());var i=e.project(n,o),l=e.project(r,o),s=e.project(a,o),c=t.LineUtil.closestPointOnSegment(i,l,s);return e.unproject(c,o)},closest:function(e,n,r,a){"function"!=typeof n.getLatLngs&&(n=t.polyline(n));var o,i,l,s=n.getLatLngs().slice(0),c=1/0,u=null;if(a){for(o=0,i=s.length;i>o;o++){var g=s[o];l=t.GeometryUtil.distance(e,r,g),c>l&&(c=l,u=g,u.distance=l)}return u}for(n instanceof t.Polygon&&s.push(s[0]),o=0,i=s.length;i-1>o;o++){var f=s[o],L=s[o+1];l=t.GeometryUtil.distanceSegment(e,r,f,L),c>=l&&(c=l,u=t.GeometryUtil.closestOnSegment(e,r,f,L),u.distance=l)}return u},closestLayer:function(e,n,r){var a=1/0,o=null,i=null,l=1/0;for(var s in n._layers){var c=n._layers[s];"function"==typeof c.getLatLng?(i=c.getLatLng(),l=t.GeometryUtil.distance(e,r,i)):(i=t.GeometryUtil.closest(e,c,r),i&&(l=i.distance)),a>l&&(a=l,o={layer:c,latlng:i,distance:l})}return o},layersWithin:function(e,n,r,a){a="number"==typeof a?a:1/0;for(var o=[],i=null,l=0,s=0,c=n.length;c>s;s++){var u=n[s];"function"==typeof u.getLatLng?(i=u.getLatLng(),l=t.GeometryUtil.distance(e,r,i)):(i=t.GeometryUtil.closest(e,u,r),i&&(l=i.distance)),i&&a>l&&o.push({layer:u,latlng:i,distance:l})}var g=o.sort(function(t,e){return t.distance-e.distance});return g},closestLayerSnap:function(e,n,r,a,o){a="number"==typeof a?a:1/0,o="boolean"==typeof o?o:!0;var i=t.GeometryUtil.closestLayer(e,n,r);if(!i||i.distance>a)return null;if(o&&"function"==typeof i.layer.getLatLngs){var l=t.GeometryUtil.closest(e,i.layer,i.latlng,!0);l.distance<a&&(i.latlng=l,i.distance=t.GeometryUtil.distance(e,l,r))}return i},interpolateOnPointSegment:function(e,n,r){return t.point(e.x*(1-r)+r*n.x,e.y*(1-r)+r*n.y)},interpolateOnLine:function(e,n,r){n=n instanceof t.Polyline?n.getLatLngs():n;var a=n.length;if(2>a)return null;if(r=Math.max(Math.min(r,1),0),0===r)return{latLng:n[0]instanceof t.LatLng?n[0]:t.latLng(n[0]),predecessor:-1};if(1==r)return{latLng:n[n.length-1]instanceof t.LatLng?n[n.length-1]:t.latLng(n[n.length-1]),predecessor:n.length-2};var o=e.getMaxZoom();o===1/0&&(o=e.getZoom());for(var i=[],l=0,s=0;a>s;s++)i[s]=e.project(n[s],o),s>0&&(l+=i[s-1].distanceTo(i[s]));for(var c=l*r,u=i[0],g=i[1],f=0,L=u.distanceTo(g),h=1;a>h&&c>L;h++)u=g,f=L,g=i[h],L+=u.distanceTo(g);var y=L-f!==0?(c-f)/(L-f):0,d=t.GeometryUtil.interpolateOnPointSegment(u,g,y);return{latLng:e.unproject(d,o),predecessor:h-2}},locateOnLine:function(e,n,r){var a=n.getLatLngs();if(r.equals(a[0]))return 0;if(r.equals(a[a.length-1]))return 1;for(var o=t.GeometryUtil.closest(e,n,r,!1),i=t.GeometryUtil.accumulatedLengths(a),l=i[i.length-1],s=0,c=!1,u=0,g=a.length-1;g>u;u++){var f=a[u],L=a[u+1];if(s=i[u],t.GeometryUtil.belongsSegment(o,f,L)){s+=f.distanceTo(o),c=!0;break}}if(!c)throw"Could not interpolate "+r.toString()+" within "+n.toString();return s/l},reverse:function(e){return t.polyline(e.getLatLngs().slice(0).reverse())},extract:function(e,n,r,a){if(r>a)return t.GeometryUtil.extract(e,t.GeometryUtil.reverse(n),1-r,1-a);r=Math.max(Math.min(r,1),0),a=Math.max(Math.min(a,1),0);var o=n.getLatLngs(),i=t.GeometryUtil.interpolateOnLine(e,n,r),l=t.GeometryUtil.interpolateOnLine(e,n,a);if(r==a){var s=t.GeometryUtil.interpolateOnLine(e,n,a);return[s.latLng]}-1==i.predecessor&&(i.predecessor=0),-1==l.predecessor&&(l.predecessor=0);var c=o.slice(i.predecessor+1,l.predecessor+1);return c.unshift(i.latLng),c.push(l.latLng),c},isBefore:function(t,e){if(!e)return!1;var n=t.getLatLngs(),r=e.getLatLngs();return n[n.length-1].equals(r[0])},isAfter:function(t,e){if(!e)return!1;var n=t.getLatLngs(),r=e.getLatLngs();return n[0].equals(r[r.length-1])},startsAtExtremity:function(t,e){if(!e)return!1;var n=t.getLatLngs(),r=e.getLatLngs(),a=n[0];return a.equals(r[0])||a.equals(r[r.length-1])},computeAngle:function(t,e){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI},computeSlope:function(t,e){var n=(e.y-t.y)/(e.x-t.x),r=t.y-n*t.x;return{a:n,b:r}},rotatePoint:function(e,n,r,a){var o=e.getMaxZoom();o===1/0&&(o=e.getZoom());var i=r*Math.PI/180,l=e.project(n,o),s=e.project(a,o),c=Math.cos(i)*(l.x-s.x)-Math.sin(i)*(l.y-s.y)+s.x,u=Math.sin(i)*(l.x-s.x)+Math.cos(i)*(l.y-s.y)+s.y;return e.unproject(new t.Point(c,u),o)},bearing:function(t,e){var n=Math.PI/180,r=t.lat*n,a=e.lat*n,o=t.lng*n,i=e.lng*n,l=Math.sin(i-o)*Math.cos(a),s=Math.cos(r)*Math.sin(a)-Math.sin(r)*Math.cos(a)*Math.cos(i-o),c=(180*Math.atan2(l,s)/Math.PI+360)%360;return c>=180?c-360:c},destination:function(e,n,r){n=(n+360)%360;var a=Math.PI/180,o=180/Math.PI,i=6378137,l=e.lng*a,s=e.lat*a,c=n*a,u=Math.sin(s),g=Math.cos(s),f=Math.cos(r/i),L=Math.sin(r/i),h=Math.asin(u*f+g*L*Math.cos(c)),y=l+Math.atan2(Math.sin(c)*L*g,f-u*Math.sin(h));return y*=o,y=y>180?y-360:-180>y?y+360:y,t.latLng([h*o,y])}}),t.GeometryUtil});